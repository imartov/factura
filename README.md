# Содержание

1. [Аннотация](#аннотация)
2. [Установка](#установка)
3. [Окружение](#окружение)
4. [Работа с шаблоном <b>xlsx</b>](#шаблон_xlsx)  
4.1. [Вид документа](#вид_документа)  
4.2. [Данные о покупателе](#данные_о_покупателе)  
4.3. [Налог](#налог)  
4.4. [Валюта](#валюта)  
4.5. [Мера имерения](#мера_измерения)  
4.6. [Данные о товарах](#данные_о_товарах)  
4.7. [Данные о продавце](#данные_о_продавце)
5. [Сценарий использования](#сценария_использования)

<br/>

## <a name='аннотация'>1. Аннотация</a>

Внимательно прочтите изложенные здесь инструкции и наслаждайтесь работой с <b>FacturaPy</b>.  
<b>FacturaPy</b> предназначена для автоматизации процесса формирования транспортных документов, необходимых для предоставления отчетности в Республике Польше, посредством web-сайта https://www.fakturowo.pl/.  
<b>FacturaPy</b> является полностью независимой и исполняемыой программой формата .exe. Для ее корректной работы не нужны какие-либо дополнительные файлы, утилиты и т.д. Достаточно просто скачать программу и начать ее использовать.

<br/>

## <a name='установка'>2. Установка</a>

Для установки программы выполните следующие шаги:  
1. Перейдите по предоставленной разработчиком персональной ссылке. При переходе Вы попадаете в приватный репозиторий в <a href="https://github.com/" target="_blank">GitHub</a>, доступ к которому имеется только у разработчиков и пользователей с прямой ссылкой.

2. Кликните на файл <b>FacturaPy</b>  
![image](https://user-images.githubusercontent.com/116018998/232195611-789b8ff8-26ca-4903-9be6-a79f3ba91edc.png)

3. Кликните на кнопку загрузки <b>Download</b>  
![image](https://user-images.githubusercontent.com/116018998/232195725-a0a4da17-1776-43ef-9037-ddcc70d73a86.png)

4. Создайте папку в любом удобном для вас месте на ПК.
5. Перейдите в папку загрузок, в которую скачался файл <b>FacturaPy</b> на шаге 3, и переместите данный файл в созданную Вами папку на шаге 4.
6. Создайте в данной папке еще одну папку с именем <b>xlsx</b>.
7. Вернитесь к шагу 1.
8. Перейдите в директорий <b>xlsx</b>  
![image](https://user-images.githubusercontent.com/116018998/232198657-b9d8b1f9-339d-4d6b-bc69-257baf5e1c72.png)

9. Перейдите в файл <b>book_1.xlsx</b>  
![image](https://user-images.githubusercontent.com/116018998/232198893-40d5b37a-9971-4da3-8740-95fe9f630123.png)

10. Кликните на кнопку загрузки <b>Download</b>  
![image](https://user-images.githubusercontent.com/116018998/232199126-c9a8eac1-473d-4394-81c2-030bed8f1b5d.png)

11. Перейдите в папку загрузок, в которую скачался шаблон <b>book_1.xlsx</b>, и переместите данный файл в созданную Вами папку <b>xlsx</b> на шаге 6.

В результате у вас должна быть следующая структура:  
![image](https://user-images.githubusercontent.com/116018998/232199226-4b088841-a4c9-4ac7-a849-ebe0cce83f0a.png)
![image](https://user-images.githubusercontent.com/116018998/232199274-a7cdd5bf-0e32-46f5-ac31-e40961256301.png)

<br/>

## <a name='окружение'>3. Окружение</a>

Для корректной работы <b>FacturaPy</b> необходим установленный на устройстве браузер <b>Chrome</b> версии <b>111.0.5563.</b>[последние три цифры не имеют значения]  
![image](https://user-images.githubusercontent.com/116018998/229341814-799df1fa-5e66-4c04-a1f8-332f5d5e48bd.png)

Для того, чтобы узнать версию браузера Chrome, необходимо выполнить следующие шаги:
1. Нажать на кнопку "меню" в правом верхнем углу  
![image](https://user-images.githubusercontent.com/116018998/229342222-7f978dea-e86c-4bbf-a52c-35f2717e2a69.png)

2. Нажать на "Справка"  
![image](https://user-images.githubusercontent.com/116018998/229342406-9d30971e-1834-44dc-88ef-8f5dcdd502e9.png)

3. В раскрывшемся меню нажать на "О браузере Google Chrome"  
![image](https://user-images.githubusercontent.com/116018998/229342477-b311103c-7d32-4b44-9979-a556043869f0.png)

В результате в окне должна отображаться версия Вашего браузера Chrome  
![image](https://user-images.githubusercontent.com/116018998/229341814-799df1fa-5e66-4c04-a1f8-332f5d5e48bd.png)

Если версия отличатеся от трубуемой, перейдите по этой <a href="https://google-chrome.ru.uptodown.com/windows/download/95500106" target="_blank">ссылке</a> и установите нужную версию.

<br/>

## <a name='шаблон_xlsx'>4. Работа с шаблоном xlsx</a>

Используйте шаблон <b>book_1.xlsx</b> для работы с <b>FacturaPy</b>. <b>FacturaPy</b> получает шаблон в качестве входного файла (датафрейма), из которого извлекает данные для формирования транспортных документов. В <b>FacturaPy</b> переданы строгие адреса ячеек для каждого поля на сайте https://www.fakturowo.pl/, ввиду чего разметка шаблона не должна меняться. Заголовки таблиц и данные для них должны всегда оставаться в строго определенных местах.

### <a name='вид_документа'>4.1. Вид документа</a>

Ячейка для вида документа должна находится по адресу "В1". В данную ячейку переданы имеющиеся на сйте https://www.fakturowo.pl/ виды докуентов, содержащиеся в поле:  
![image](https://user-images.githubusercontent.com/116018998/232202469-ee10fd70-5631-4d8d-942d-51cd8ee605b4.png)

Ячейка имеет формат раскрывающегося списка. Для того, чтобы сформировать нужный документ просто раскройте список и выберете его:  
![image](https://user-images.githubusercontent.com/116018998/232202416-9c738532-9fad-4c5e-bcdd-cefb9eca3b47.png)

### <a name='данные_о_покупателе'>4.2. Данные о покупателе</a>

Данные о покупателе должны находится в диапозоне "В2:В6":  
![image](https://user-images.githubusercontent.com/116018998/232202586-3dccae25-6d18-4cd6-ac74-e61d4f477a48.png)

По техническому заданию заказчика в ячейки переданы определенные значения для двух компаний. С целью недопущения изменения формулы ячейки представлены также в формате раскрывающегося списка. Для того, чтобы выбрать компании, раскройте список с именем компании и выберите нужную:  
![image](https://user-images.githubusercontent.com/116018998/232202732-c4842777-f1e6-4d10-a780-8f8f1d58a3f7.png)

Данные в остальные поля подятнуться автоматически в виде единственного варианта выбора, при этом их также нужно выбрать:  
![image](https://user-images.githubusercontent.com/116018998/232202849-55911e42-4bc9-44ff-8702-e2c97a85f9ba.png)

Кроме этого, в данные ячейки также можно ввести иные данные без потери данных об определенных двух компаниях:  
![image](https://user-images.githubusercontent.com/116018998/232203183-ee8ef2fb-4bd0-45af-a3ec-1dd11ea3b2fa.png)

Переданные в ячейки данные будут заполнены в следующие поля на сайте:  
![image](https://user-images.githubusercontent.com/116018998/232203650-ff936bf5-431c-4bcf-b39e-283ee3223065.png)

### <a name='налог'>4.3. Налог</a>

Данные о размере налога должны находится в ячейке "В7":  
![image](https://user-images.githubusercontent.com/116018998/232203980-5bf36ed7-0a77-4d18-83ef-1a5d574f7d8c.png)

Данная ячейка представлена в формате раскрывающегося списка и имеет предопределенные значения. Для выбора размера налога раскройте список и выберите его:  
![image](https://user-images.githubusercontent.com/116018998/232204395-91dbde8c-c3ae-479a-965b-e2900cd845db.png)

В данную ячейку можно поместить свое значение, при этом такое значение должно полностью соответствовать значению, представленному для соответствующего поля на сайте:  
![image](https://user-images.githubusercontent.com/116018998/232204795-d7659a8f-2c5f-43f4-9863-a0b81f8ff9a0.png)
Но вводить свои значения не рекомендуется по причине различного форматирования значений на сайте и в шаблоне, в результате чего нужный налог может быть не выбран, а <b>FacturaPy</b> может привести к сбою.

### <a name='валюта'>4.4. Валюта</a>

Данные о валюте должны находится в ячейке "В8":  
![image](https://user-images.githubusercontent.com/116018998/232205288-77b407c9-674c-4aee-a295-4571fdd2817e.png)

Правила заполнения и обработки аналогичны ячейке для [налога](#налог).

### <a name='мера_измерения'>4.5. Мера измерения</a>

Данные о валюте должны находится в ячейке "В9":  
![image](https://user-images.githubusercontent.com/116018998/232205406-f81cb148-43c2-4333-aa4a-51a01f4bdcaf.png)

Правила заполнения и обработки аналогичны ячейке для [налога](#налог).

### <a name='данные_о_товарах'>4.6. Данные о товарах</a>

А данные о товаре, его колиестве и цене должныи следовать в тех же столбцах со строки 13:  
![image](https://user-images.githubusercontent.com/116018998/232201114-336690e8-0d6a-434d-aef9-e359c276c6f1.png)





<br/>

## <a name='сценария_использования'>Сценарий использования</a>

![Untitled Workspace](https://user-images.githubusercontent.com/116018998/229340061-820b693f-3646-4113-b7cb-ddb0ffe9635c.png)


## Инструкция

1. Скачайте excel шаблон и поместите в папку 'xlsx'
2. Внесите данные в соответствующие поля в excel шаблоне
3. Сохраните excel шаблон
4. Запустите программу
5. Дождитесь окончания проверки excel шаблона
6. При наличии пустых / некоррктных полей в excel шаблоне устраните недостатки
7. Введите логин и пароль от https://www.fakturowo.pl/
8. Дождитесь окончания выполнения factura.py
9. Проверьте корректность заполненных полей
10. Возобновите выполнение factura.py
11. Получите готовые транспортные документы в папке загрузок


## Особенности



## Ошибки / сбои

В ходе разработки протестировано множество сценариев, связанных с возникновением ошибок, препятствующих корректной работе программы. Источником их возникновения могут служить как особенности, связанные с программной обработкой excel файлов, так и особенности работы web-сайта.
Отличным инструментом для минимизации сбоев явялется модуль, выполняющий первоначальную проверку входных excel файлов: <b>factura.py</b> не приступит к формированию транспортных документов пока во входных excel файлах будут присутствовать пустые либо некорректные поля.
В случае обнаружения полей в excel файлах, не соответствующих требованиям, <b>factura.py</b> попросит Вас самостоятельно устранить недостатки

### Исключения

## Правила использования

* программа все сделает за Вас. Главной идей данной программы является полная автоматизация процесса. Для корректной ее работы не рекомендуется самостоятельно нажимать на кнопки на сайте, вводить значения в какие-либо поля, выполянть иные действия, которые будут иметь результат на сайте, пока программа сама Вас об этом не попросит.
* 

# схема использования
